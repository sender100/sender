<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Family Photo Vault</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    body { font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji"; }
    .glass { background: rgba(255,255,255,0.08); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.15); }
    .btn { @apply px-4 py-2 rounded-2xl shadow transition active:scale-[.98]; }
    .btn-primary { @apply bg-indigo-600 hover:bg-indigo-500 text-white; }
    .btn-outline { @apply border border-white/30 hover:bg-white/10 text-white; }
    .btn-danger { @apply bg-rose-600 hover:bg-rose-500 text-white; }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-indigo-700 via-fuchsia-600 to-rose-600 text-white">
  <!-- NAVBAR -->
  <header class="sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="h-10 w-10 rounded-2xl bg-white/10 grid place-items-center">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="currentColor"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9-4.03-9-9-9Zm4.95 12.54-3.2-3.99c-.38-.47-1.08-.53-1.53-.13l-2.02 1.74-1.22-1.46a1 1 0 0 0-1.68.17l-2.02 3.74a8 8 0 1 1 11.67-1.07Z"/></svg>
        </div>
        <h1 class="text-2xl font-extrabold tracking-tight">Family Photo Vault</h1>
      </div>
      <div class="flex items-center gap-3">
        <span id="userEmail" class="text-sm opacity-90 hidden"></span>
        <button id="btnLogout" class="btn btn-outline hidden">Logout</button>
        <button id="btnLoginOpen" class="btn btn-primary">Login / Sign up</button>
      </div>
    </div>
  </header>

  <!-- HERO -->
  <section class="max-w-7xl mx-auto px-4 pt-10 pb-4">
    <div class="glass rounded-3xl p-6 md:p-10 shadow-xl">
      <div class="grid md:grid-cols-2 gap-8 items-center">
        <div>
          <h2 class="text-3xl md:text-4xl font-extrabold leading-tight">Secure, shared gallery for the whole family</h2>
          <p class="mt-3 text-white/90">Upload, view, and manage memories in a private space. Only signed-in family members can access your photos.</p>
          <div class="mt-5 flex gap-3">
            <button id="ctaUpload" class="btn btn-primary">Upload photos</button>
            <a href="#gallery" class="btn btn-outline">View gallery</a>
          </div>
        </div>
        <div class="grid grid-cols-3 gap-2 md:gap-3">
          <div class="rounded-2xl overflow-hidden aspect-[4/5] bg-white/10"></div>
          <div class="rounded-2xl overflow-hidden aspect-square bg-white/10"></div>
          <div class="rounded-2xl overflow-hidden aspect-[3/4] bg-white/10"></div>
          <div class="rounded-2xl overflow-hidden aspect-[3/4] bg-white/10"></div>
          <div class="rounded-2xl overflow-hidden aspect-square bg-white/10"></div>
          <div class="rounded-2xl overflow-hidden aspect-[4/5] bg-white/10"></div>
        </div>
      </div>
    </div>
  </section>

  <!-- UPLOAD -->
  <section class="max-w-7xl mx-auto px-4 pt-6 pb-2">
    <div class="glass rounded-3xl p-6 md:p-8">
      <div class="flex items-center justify-between gap-4">
        <div>
          <h3 class="text-xl md:text-2xl font-bold">Upload images</h3>
          <p class="text-white/80 text-sm">Accepted: JPG, PNG, WEBP, HEIC ‚Ä¢ Max ~10MB/file</p>
        </div>
        <div class="flex gap-2">
          <select id="memberSelect" class="rounded-2xl bg-white/10 border border-white/20 px-3 py-2 text-sm">
            <option value="shared">Shared Album</option>
            <option>Dad</option>
            <option>Mom</option>
            <option>Kids</option>
            <option>Grandparents</option>
          </select>
          <button id="btnPickFiles" class="btn btn-primary">Choose files</button>
          <input id="fileInput" type="file" accept="image/*" multiple class="hidden" />
        </div>
      </div>
      <div id="dropZone" class="mt-4 rounded-2xl border-2 border-dashed border-white/30 bg-white/5 p-6 text-center">
        <p class="font-medium">Drag & drop photos here</p>
        <p class="text-sm text-white/80">or click ‚ÄúChoose files‚Äù</p>
      </div>
      <div id="queue" class="mt-4 grid sm:grid-cols-2 lg:grid-cols-3 gap-3"></div>
      <div id="uploadStatus" class="mt-3 text-sm"></div>
    </div>
  </section>

  <!-- GALLERY -->
  <section id="gallery" class="max-w-7xl mx-auto px-4 pt-6 pb-20">
    <div class="flex items-center justify-between mb-3">
      <h3 class="text-xl md:text-2xl font-bold">Gallery</h3>
      <div class="flex gap-2 items-center">
        <select id="filterSelect" class="rounded-2xl bg-white/10 border border-white/20 px-3 py-2 text-sm">
          <option value="all">All</option>
          <option value="shared">Shared Album</option>
          <option>Dad</option>
          <option>Mom</option>
          <option>Kids</option>
          <option>Grandparents</option>
        </select>
        <button id="refreshBtn" class="btn btn-outline">Refresh</button>
      </div>
    </div>
    <div id="galleryGrid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3"></div>
    <p id="emptyState" class="text-white/80 text-center mt-6 hidden">No photos yet. Upload some memories! ü•∞</p>
  </section>

  <!-- AUTH MODAL -->
  <div id="authModal" class="fixed inset-0 hidden items-center justify-center bg-black/60 p-4">
    <div class="w-full max-w-md glass rounded-3xl p-6">
      <div class="flex items-center justify-between mb-4">
        <h3 class="text-xl font-bold">Sign in / Create account</h3>
        <button id="authClose" class="btn btn-outline">Close</button>
      </div>
      <div class="grid gap-3">
        <input id="emailInput" type="email" placeholder="Email" class="w-full rounded-2xl bg-white/10 border border-white/20 px-4 py-3"/>
        <input id="passwordInput" type="password" placeholder="Password (min 6 chars)" class="w-full rounded-2xl bg-white/10 border border-white/20 px-4 py-3"/>
        <div class="flex gap-2">
          <button id="btnLogin" class="btn btn-primary w-full">Login</button>
          <button id="btnRegister" class="btn btn-outline w-full">Register</button>
        </div>
        <p id="authMsg" class="text-sm text-white/90"></p>
      </div>
      <p class="mt-4 text-xs text-white/70">By continuing you agree this private site is for family only. Keep your password safe.</p>
    </div>
  </div>

  <!-- TOAST -->
  <div id="toast" class="fixed bottom-4 left-1/2 -translate-x-1/2 hidden px-4 py-2 rounded-2xl glass"></div>

  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAuth, onAuthStateChanged, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import { getStorage, ref, uploadBytes, getDownloadURL, listAll, deleteObject } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-storage.js";

  const firebaseConfig = {
  apiKey: "AIzaSy",
  authDomain: "sender-app-ee836.firebaseapp.com",
  databaseURL: "https://sender-app-ee836-default-rtdb.firebaseio.com",
  projectId: "sender-app-ee836",
  storageBucket: "sender-app-ee836.appspot.com",
  messagingSenderId: "1234567890",
  appId: "1:1234567890:web:abcd1234"
};



    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const storage = getStorage(app);

    // DOM
    const authModal = document.getElementById("authModal");
    const btnLoginOpen = document.getElementById("btnLoginOpen");
    const btnLogout = document.getElementById("btnLogout");
    const authClose = document.getElementById("authClose");
    const btnLogin = document.getElementById("btnLogin");
    const btnRegister = document.getElementById("btnRegister");
    const emailInput = document.getElementById("emailInput");
    const passwordInput = document.getElementById("passwordInput");
    const authMsg = document.getElementById("authMsg");
    const userEmail = document.getElementById("userEmail");
    const fileInput = document.getElementById("fileInput");
    const btnPickFiles = document.getElementById("btnPickFiles");
    const dropZone = document.getElementById("dropZone");
    const queue = document.getElementById("queue");
    const uploadStatus = document.getElementById("uploadStatus");
    const memberSelect = document.getElementById("memberSelect");
    const galleryGrid = document.getElementById("galleryGrid");
    const filterSelect = document.getElementById("filterSelect");
    const emptyState = document.getElementById("emptyState");
    const toast = document.getElementById("toast");

    // Toast
    function showToast(msg) {
      toast.textContent = msg;
      toast.classList.remove("hidden");
      setTimeout(() => toast.classList.add("hidden"), 3000);
    }

    // Auth
    btnLoginOpen.onclick = () => authModal.classList.remove("hidden");
    authClose.onclick = () => authModal.classList.add("hidden");

    btnLogin.onclick = async () => {
      try {
        await signInWithEmailAndPassword(auth, emailInput.value, passwordInput.value);
        authMsg.textContent = "‚úÖ Logged in!";
        authModal.classList.add("hidden");
      } catch (e) {
        authMsg.textContent = e.message;
      }
    };

    btnRegister.onclick = async () => {
      try {
        await createUserWithEmailAndPassword(auth, emailInput.value, passwordInput.value);
        authMsg.textContent = "‚úÖ Account created!";
        authModal.classList.add("hidden");
      } catch (e) {
        authMsg.textContent = e.message;
      }
    };

    btnLogout.onclick = async () => { await signOut(auth); };

    onAuthStateChanged(auth, user => {
      if (user) {
        userEmail.textContent = user.email;
        userEmail.classList.remove("hidden");
        btnLogout.classList.remove("hidden");
        btnLoginOpen.classList.add("hidden");
        loadGallery();
      } else {
        userEmail.classList.add("hidden");
        btnLogout.classList.add("hidden");
        btnLoginOpen.classList.remove("hidden");
        galleryGrid.innerHTML = "";
      }
    });

    // Upload
    btnPickFiles.onclick = () => fileInput.click();
    fileInput.onchange = () => handleFiles(fileInput.files);

    dropZone.ondragover = e => { e.preventDefault(); dropZone.classList.add("bg-white/20"); };
    dropZone.ondragleave = () => dropZone.classList.remove("bg-white/20");
    dropZone.ondrop = e => { e.preventDefault(); dropZone.classList.remove("bg-white/20"); handleFiles(e.dataTransfer.files); };

    function handleFiles(files) {
      [...files].forEach(uploadFile);
    }

    async function uploadFile(file) {
      if (!auth.currentUser) return showToast("Login required");
      if (file.size > 10*1024*1024) return showToast("‚ùå File too large");
      const album = memberSelect.value;
      const storageRef = ref(storage, `${album}/${Date.now()}-${file.name}`);
      try {
        await uploadBytes(storageRef, file);
        showToast("‚úÖ Uploaded");
        loadGallery();
      } catch(e) { showToast("‚ùå Upload failed"); }
    }

    // Gallery
    async function loadGallery() {
      galleryGrid.innerHTML = "";
      const filter = filterSelect.value;
      const folders = filter === "all" ? ["shared","Dad","Mom","Kids","Grandparents"] : [filter];
      let allUrls = [];
      for (const folder of folders) {
        const folderRef = ref(storage, folder);
        try {
          const res = await listAll(folderRef);
          for (const item of res.items) {
            const url = await getDownloadURL(item);
            allUrls.push({url, path: item.fullPath});
          }
        } catch(e) { console.log("No folder", folder); }
      }
      if (allUrls.length === 0) emptyState.classList.remove("hidden"); else emptyState.classList.add("hidden");
      allUrls.forEach(({url, path}) => {
        const div = document.createElement("div");
        div.className = "relative group rounded-2xl overflow-hidden";
        div.innerHTML = `
          <img src="${url}" class="w-full h-48 object-cover"/>
          <button class="absolute top-2 right-2 btn btn-danger hidden group-hover:block">Delete</button>
        `;
        div.querySelector("button").onclick = async () => {
          if (confirm("Delete photo?")) {
            await deleteObject(ref(storage, path));
            showToast("üóëÔ∏è Deleted");
            loadGallery();
          }
        };
        galleryGrid.appendChild(div);
      });
    }

    filterSelect.onchange = loadGallery;
    document.getElementById("refreshBtn").onclick = loadGallery;
  </script>
</body>
</html>
